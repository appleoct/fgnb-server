webpackJsonp([4],{"1oUx":function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},"45CA":function(t,e,n){"use strict";var a=n("s8Ph"),o={name:"CategoryList",props:{categoryType:Number,projectId:Number},data:function(){return{categoryList:[]}},methods:{handleCurrentChange:function(t){this.$emit("selectCategoryRow",t)},requestGetCategoriesByProjectIdAndCategoryType:function(){var t=this;Object(a.b)(this.projectId,this.categoryType).then(function(e){t.categoryList=e.data,t.categoryList.splice(0,0,{categoryId:null,projectId:t.projectId,categoryName:"全部"})})}},created:function(){this.requestGetCategoriesByProjectIdAndCategoryType()},updated:function(){this.$refs.categoryTable.setCurrentRow(this.categoryList[0])}},s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-table",{ref:"categoryTable",attrs:{data:this.categoryList,"highlight-current-row":"",border:""},on:{"current-change":this.handleCurrentChange}},[e("el-table-column",{attrs:{property:"categoryName",label:"分类",align:"center"}})],1)],1)},staticRenderFns:[]};var i=n("VU/8")(o,s,!1,function(t){n("tpX5")},"data-v-29f3f392",null);e.a=i.exports},"8S8/":function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},"J4y/":function(t,e,n){var a=n("1oUx");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("16c31ef1",a,!0)},OuoE:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},d7vy:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},g6xb:function(t,e,n){var a=n("gler");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("f78f4950",a,!0)},gler:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\nhr[data-v-4c5df306] {\n  border:0;\n  background-color:#D6D6D6;\n  height:1px;\n}\n\n",""])},ldei:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("mvHQ"),o=n.n(a),s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.addVar}},[t._v("添加局部变量")]),t._v(" "),n("el-table",{staticStyle:{"margin-top":"8px"},attrs:{data:t.actionVars,border:""}},[n("el-table-column",{attrs:{label:"变量名",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{clearable:""},model:{value:e.row.actionVarName,callback:function(n){t.$set(e.row,"actionVarName",n)},expression:"scope.row.actionVarName"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"变量值",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{clearable:""},model:{value:e.row.actionVarValue,callback:function(n){t.$set(e.row,"actionVarValue",n)},expression:"scope.row.actionVarValue"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"变量描述",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{clearable:""},model:{value:e.row.description,callback:function(n){t.$set(e.row,"description",n)},expression:"scope.row.description"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){t.deleteActionVar(e.$index)}}},[t._v("删除")])]}}])})],1)],1)},staticRenderFns:[]};var i=n("VU/8")({name:"ActionVarList",data:function(){return{actionVars:[]}},methods:{addVar:function(){this.actionVars.push({actionVarName:"",actionVarValue:"",description:""})},deleteActionVar:function(t){this.actionVars.splice(t,1)}},watch:{actionVars:{handler:function(t){this.$emit("actionVarListChange",t)},deep:!0}}},s,!1,function(t){n("J4y/")},"data-v-4caad8b9",null).exports,r=n("2Aet"),c=n("96hP"),l=n("lCmq"),u=n("s8Ph"),d={name:"SaveAction",props:{projectId:Number,actionType:Number,actionId:Number,isAdd:{type:Boolean,default:!1}},components:{ActionVarList:i,GlobalVariableList:r.a,ActionStepList:c.a},watch:{actionId:function(){var t=this;this.actionId&&(this.loading=!0,Object(l.i)(this.actionId).then(function(e){t.saveTestCaseActionForm=e.data,t.testCaseCategories=[{categoryId:t.saveTestCaseActionForm.categoryId,categoryName:t.saveTestCaseActionForm.categoryName}],t.$refs.ActionVarList.actionVars=t.saveTestCaseActionForm.actionVars,t.$refs.ActionVarList.returnValue=t.saveTestCaseActionForm.returnValue,t.$refs.ActionStepList.actionSteps=t.saveTestCaseActionForm.actionSteps,t.saveTestCaseActionForm.actionSteps.forEach(function(e){t.$refs.ActionStepList.selectableActions.push({actionName:e.stepActionName,actionId:e.stepActionId})}),t.loading=!1}).catch(function(e){t.loading=!1}))}},data:function(){return{addTestCaseCategoryDialogVisible:!1,saveTestCaseCategoryForm:{projectId:this.projectId,categoryType:2},testCaseCategories:[],loading:!1,saveActionBtnLoading:!1,debugActionBtnLoading:!1,saveTestCaseActionForm:{actionType:this.actionType,projectId:this.projectId}}},methods:{globalVarListChange:function(t){this.$refs.ActionStepList.globalVars=t},actionVarListChange:function(t){this.$refs.ActionStepList.evaluations=t},getCategoriesByProjectIdAndCategoryType:function(t){var e=this;!0===t&&Object(u.b)(this.projectId,2).then(function(t){e.testCaseCategories=t.data})},saveTestCaseCategory:function(){var t=this;Object(u.a)(this.saveTestCaseCategoryForm).then(function(e){t.$notify.success(e.msg),t.addTestCaseCategoryDialogVisible=!1,t.$emit("saveCategorySuccess")})},debugAction:function(){var t=this,e=JSON.parse(o()(this.saveTestCaseActionForm));if(e.actionSteps=this.$refs.ActionStepList.selectedSteps,e.actionSteps.length<=0)this.$notify.error("至少要勾选1个步骤进行调试");else{e.actionSteps.forEach(function(t,e){t.actionStepNumber=e+1}),e.globalVars=this.$refs.GlobalVariableList.globalVarList,e.actionVars=this.$refs.ActionVarList.actionVars,console.log("Debug Action",e);var n=localStorage.getItem("agentIp"),a=localStorage.getItem("deviceId"),s=localStorage.getItem("uiautomator_server_port");e.agentIp=n,e.deviceId=a,e.uiautomatorServerPort=s,this.debugActionBtnLoading=!0,Object(l.b)(e).then(function(e){t.$notify.success(e.msg),t.debugActionBtnLoading=!1}).catch(function(e){t.debugActionBtnLoading=!1})}},saveTestCaseAction:function(){var t=this;this.saveActionBtnLoading=!0;try{this.saveTestCaseActionForm.actionVars=this.$refs.ActionVarList.actionVars,this.saveTestCaseActionForm.actionSteps=this.$refs.ActionStepList.actionSteps,this.saveTestCaseActionForm.actionSteps&&this.saveTestCaseActionForm.actionSteps.length>0&&this.saveTestCaseActionForm.actionSteps.forEach(function(t,e){t.actionStepNumber=e+1}),this.isAdd?Object(l.a)(this.saveTestCaseActionForm).then(function(e){t.$notify.success(e.msg),t.saveActionBtnLoading=!1,t.$emit("saveActionSuccess")}).catch(function(e){t.saveActionBtnLoading=!1}):Object(l.k)(this.saveTestCaseActionForm).then(function(e){t.$notify.success(e.msg),t.saveActionBtnLoading=!1,t.$emit("saveActionSuccess")}).catch(function(e){t.saveActionBtnLoading=!1})}catch(t){this.saveActionBtnLoading=!1}}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[n("el-row",{attrs:{gutter:5}},[n("el-col",{attrs:{span:12}},[n("el-form",{attrs:{"label-width":"120px"}},[n("el-form-item",{attrs:{label:"TestCase名",rules:[{required:!0}]}},[n("el-input",{model:{value:t.saveTestCaseActionForm.actionName,callback:function(e){t.$set(t.saveTestCaseActionForm,"actionName",e)},expression:"saveTestCaseActionForm.actionName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{model:{value:t.saveTestCaseActionForm.description,callback:function(e){t.$set(t.saveTestCaseActionForm,"description",e)},expression:"saveTestCaseActionForm.description"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"分类",rules:[{required:!0}]}},[n("el-select",{attrs:{clearable:"",filterable:""},on:{"visible-change":t.getCategoriesByProjectIdAndCategoryType},model:{value:t.saveTestCaseActionForm.categoryId,callback:function(e){t.$set(t.saveTestCaseActionForm,"categoryId",e)},expression:"saveTestCaseActionForm.categoryId"}},t._l(t.testCaseCategories,function(t){return n("el-option",{attrs:{value:t.categoryId,label:t.categoryName}})})),t._v(" "),n("el-button",{on:{click:function(e){t.addTestCaseCategoryDialogVisible=!0}}},[t._v("+")])],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{size:"mini",type:"primary",loading:t.saveActionBtnLoading},on:{click:t.saveTestCaseAction}},[t._v("保存")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"success",loading:t.debugActionBtnLoading},on:{click:t.debugAction}},[t._v("调试")])],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("div",{staticStyle:{height:"220px",overflow:"auto"}},[n("GlobalVariableList",{ref:"GlobalVariableList",attrs:{"project-id":t.projectId},on:{globalVarListChange:t.globalVarListChange}})],1)])],1),t._v(" "),n("hr"),t._v(" "),n("el-row",[n("el-col",[n("div",{staticStyle:{"max-height":"300px",overflow:"auto"}},[n("ActionVarList",{ref:"ActionVarList",on:{actionVarListChange:t.actionVarListChange}})],1)])],1),t._v(" "),n("hr"),t._v(" "),n("el-row",[n("ActionStepList",{ref:"ActionStepList",attrs:{"project-id":t.projectId}})],1),t._v(" "),n("el-dialog",{attrs:{title:"添加TestCase分类",visible:t.addTestCaseCategoryDialogVisible,center:"",width:"500px"},on:{"update:visible":function(e){t.addTestCaseCategoryDialogVisible=e}}},[n("el-form",{attrs:{data:t.saveTestCaseCategoryForm,"label-width":"80px"}},[n("el-form-item",{staticClass:"content-center",attrs:{label:"分类名",rules:[{required:!0}]}},[n("el-input",{staticStyle:{width:"300px"},attrs:{clearable:""},model:{value:t.saveTestCaseCategoryForm.categoryName,callback:function(e){t.$set(t.saveTestCaseCategoryForm,"categoryName","string"==typeof e?e.trim():e)},expression:"saveTestCaseCategoryForm.categoryName"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.addTestCaseCategoryDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.saveTestCaseCategory}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var g=n("VU/8")(d,p,!1,function(t){n("g6xb")},"data-v-4c5df306",null).exports,f=n("45CA"),v={name:"ActionList",props:{projectId:Number,actionType:Number},components:{CategoryList:f.a},data:function(){return{actionList:[],pages:null,total:0,queryTestCaseListForm:{pageIndex:1,countPerPage:12,actionType:this.actionType},selectableActionList:[],selectableCreatorList:[],selectableUpdatorList:[]}},methods:{selectAction:function(t){var e=this;t&&Object(l.d)(this.projectId,this.actionType).then(function(t){e.selectableActionList=t.data})},selectCreator:function(t){var e=this;t&&Object(l.f)(this.projectId,this.actionType).then(function(t){e.selectableCreatorList=t.data})},selectUpdator:function(t){var e=this;t&&Object(l.h)(this.projectId,this.actionType).then(function(t){e.selectableUpdatorList=t.data})},onSelectCategoryRow:function(t){this.queryTestCaseListForm.projectId=this.projectId,this.queryTestCaseListForm.categoryId=t.categoryId,this.queryTestCaseListForm.pageIndex=1,this.requestActionList()},onClickCopyActionBtn:function(t){this.$emit("copyActionBtnClicked",t.actionId)},onClickUpdateActionBtn:function(t){this.$emit("updateActionBtnClicked",t.actionId)},deleteAction:function(t){var e=this;this.$confirm("删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.c)(t.actionId).then(function(t){e.$notify.success(t.msg),e.requestActionList()})})},requestActionList:function(){var t=this;Object(l.j)(this.queryTestCaseListForm).then(function(e){t.actionList=e.data.data,t.total=e.data.total,t.pages=e.data.pages})},handleCurrentChange:function(t){console.log("点击页码",t),this.queryTestCaseListForm.pageIndex=t,this.requestActionList()},queryTestCaseList:function(){this.queryTestCaseListForm.pageIndex=1,this.requestActionList()},freshCategoryList:function(){this.$refs.CategoryList.requestGetCategoriesByProjectIdAndCategoryType()}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",[n("el-select",{attrs:{placeholder:"用例名",clearable:"",filterable:""},on:{"visible-change":t.selectAction},model:{value:t.queryTestCaseListForm.actionId,callback:function(e){t.$set(t.queryTestCaseListForm,"actionId",e)},expression:"queryTestCaseListForm.actionId"}},t._l(t.selectableActionList,function(t){return n("el-option",{attrs:{value:t.actionId,label:t.actionName}})})),t._v(" "),n("el-select",{attrs:{placeholder:"创建人",clearable:"",filterable:""},on:{"visible-change":t.selectCreator},model:{value:t.queryTestCaseListForm.creatorUid,callback:function(e){t.$set(t.queryTestCaseListForm,"creatorUid",e)},expression:"queryTestCaseListForm.creatorUid"}},t._l(t.selectableCreatorList,function(t){return n("el-option",{attrs:{value:t.creatorUid,label:t.nickname}})})),t._v(" "),n("el-select",{attrs:{placeholder:"更新人",clearable:"",filterable:""},on:{"visible-change":t.selectUpdator},model:{value:t.queryTestCaseListForm.updatorUid,callback:function(e){t.$set(t.queryTestCaseListForm,"updatorUid",e)},expression:"queryTestCaseListForm.updatorUid"}},t._l(t.selectableUpdatorList,function(t){return n("el-option",{attrs:{value:t.updatorUid,label:t.nickname}})})),t._v(" "),n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.queryTestCaseList}},[t._v("查询")])],1),t._v(" "),n("el-row",{staticStyle:{"margin-top":"10px"}},[n("el-col",{attrs:{span:3}},[n("div",{staticStyle:{"max-height":"745px",overflow:"auto"}},[n("CategoryList",{ref:"CategoryList",attrs:{projectId:t.projectId,categoryType:2},on:{selectCategoryRow:t.onSelectCategoryRow}})],1)]),t._v(" "),n("el-col",{attrs:{span:21}},[n("el-table",{attrs:{data:t.actionList,border:""}},[n("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime"}}),t._v(" "),n("el-table-column",{attrs:{label:"TestCase名",align:"center",prop:"actionName"}}),t._v(" "),n("el-table-column",{attrs:{label:"描述",align:"center",prop:"description"}}),t._v(" "),n("el-table-column",{attrs:{label:"更新时间",align:"center",prop:"updateTime"}}),t._v(" "),n("el-table-column",{attrs:{label:"创建人",align:"center",prop:"creatorNickname"}}),t._v(" "),n("el-table-column",{attrs:{label:"更新人",align:"center",prop:"updatorNickname"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(n){t.onClickCopyActionBtn(e.row)}}},[t._v("复制")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){t.onClickUpdateActionBtn(e.row)}}},[t._v("修改")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){t.deleteAction(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),t.total>t.queryTestCaseListForm.countPerPage?n("div",{staticStyle:{"margin-top":"10px"},attrs:{align:"center"}},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.queryTestCaseListForm.pageIndex,total:10*t.pages},on:{"current-change":t.handleCurrentChange}})],1):t._e()],1)],1)],1)},staticRenderFns:[]};var h={components:{SaveAction:g,ActionList:n("VU/8")(v,m,!1,function(t){n("vW1S")},"data-v-faeb63fe",null).exports},data:function(){return{projectId:localStorage.getItem("projectId")?parseInt(localStorage.getItem("projectId")):null,activeTab:"TestCase列表",actionIdOfUpdate:null,actionIdOfCopy:null}},methods:{copyActionBtnClicked:function(t){this.activeTab="添加TestCase",this.actionIdOfCopy=t},updateActionBtnClicked:function(t){this.activeTab="修改TestCase",this.actionIdOfUpdate=t},onSaveActionSuccess:function(){this.$refs.ActionList.requestActionList()},onSaveCategorySuccess:function(){this.$refs.ActionList.freshCategoryList()}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-row",[n("el-col",[n("el-tabs",{attrs:{type:"border-card"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:"TestCase列表",name:"TestCase列表"}},[n("ActionList",{ref:"ActionList",attrs:{"project-id":t.projectId,"action-type":3},on:{updateActionBtnClicked:t.updateActionBtnClicked,copyActionBtnClicked:t.copyActionBtnClicked}})],1),t._v(" "),n("el-tab-pane",{attrs:{label:"添加TestCase",name:"添加TestCase"}},[n("SaveAction",{attrs:{"project-id":t.projectId,"action-type":3,actionId:t.actionIdOfCopy,"is-add":!0},on:{saveActionSuccess:t.onSaveActionSuccess,saveCategorySuccess:t.onSaveCategorySuccess}})],1),t._v(" "),n("el-tab-pane",{attrs:{label:"修改TestCase",name:"修改TestCase"}},[n("SaveAction",{attrs:{"project-id":t.projectId,"action-type":3,actionId:t.actionIdOfUpdate},on:{saveActionSuccess:t.onSaveActionSuccess,saveCategorySuccess:t.onSaveCategorySuccess}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var b=n("VU/8")(h,y,!1,function(t){n("voJt")},null,null);e.default=b.exports},tpX5:function(t,e,n){var a=n("d7vy");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("c5dfaa90",a,!0)},vW1S:function(t,e,n){var a=n("OuoE");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("fa456d4c",a,!0)},voJt:function(t,e,n){var a=n("8S8/");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("ed92e680",a,!0)}});